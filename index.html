<!doctype html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <title>Huhn Klicker</title>
    <style>
      body {
        margin: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        background: #f0f0f0;
        font-family: Arial, sans-serif;
      }
      #counter-boxes {
        position: absolute;
        top: 20px;
        left: 20px;
        font-size: 24px;
        display: flex;
        flex-direction: column;
      }
      #button-boxes {
        position: absolute;
        top: 20px;
        left: 50%;
        transform: translateX(-50%);
        font-size: 24px;
        display: flex;
        flex-direction: column;
        align-items: center;
      }
      #button-boxes button {
        margin-top: 5px;
      }
      #container {
        position: relative;
      }
      #cage-heading {
        text-align: center;
        margin: 0;
      }
      #chicken {
        position: relative;
        z-index: 1;
        font-size: 100px;
        cursor: pointer;
        user-select: none;
      }
      .egg {
        position: absolute;
        top: 0;
        left: 50%;
        transform: translateX(-50%);
        font-size: 40px;
        animation: drop 3s forwards;
        z-index: 0;
      }
      @keyframes drop {
        0% {
          top: 0;
          opacity: 1;
        }
        100% {
          top: 200px;
          opacity: 0;
        }
      }
    #banner {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      border: 2px solid black;
      padding: 20px;
      font-size: 24px;
      display: none;
      z-index: 2;
    }
    #farm {
      position: absolute;
      top: 20px;
      right: 20px;
      border: 1px solid #333;
      padding: 10px;
      display: none;
    }
    #farm2 {
      position: absolute;
      top: 160px;
      right: 20px;
      border: 1px solid #333;
      padding: 10px;
      display: none;
    }
    #reset-btn {
      position: fixed;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
    }
    </style>
  </head>
  <body>
    <div id="counter-boxes">
      <span id="egg-count">â›“-Ei: 0</span>
      <span id="gold-count">ğŸª™ 0</span>
      <span id="merchant-count" style="display: none">HÃ¤ndler: 0</span>
      <span id="chicken-count" style="display: none">â›“-HÃ¼hner: 1</span>
      <span id="ground-egg-count" style="display: none">Boden-Ei: 0</span>
      <span id="farmer-count" style="display: none">Farmer: 0</span>
    </div>

    <div id="button-boxes">
      <button id="merchant-btn" style="display: none">
        HÃ¤ndler anheuern (5ğŸª™)
      </button>
      <button id="buy-chicken-btn" style="display: none">â›“-Huhn kaufen</button>
      <button id="buy-ground-chicken-btn" style="display: none">Bodenhaltung-Huhn kaufen (250ğŸª™)</button>
      <button id="sell-btn" style="display: none">8 Eier verkaufen</button>
      <button id="sell-ground-btn" style="display: none">8 Boden-Eier verkaufen</button>
      <button id="farmer-btn" style="display: none">
        Farmer anheuern (15ğŸª™)
      </button>
      <button id="buy-farm-btn" style="display: none">Bauernhof kaufen (100ğŸª™)</button>
      <button id="buy-farm2-btn" style="display: none">Bauernhof kaufen (1000ğŸª™)</button>
    </div>
    <div id="container">
      <h1 id="cage-heading">â›“fighaltung</h1>
      <div id="chicken">â›“ğŸ”â›“</div>
    </div>
    <div id="farm">
      <h2>Bauernhof</h2>
      <span id="farm-farmer-count">Farmer: 0</span>
      <button id="assign-farmer-btn">Farmer zuweisen</button><br />
      <span id="farm-merchant-count">HÃ¤ndler: 0</span>
      <button id="assign-merchant-btn">HÃ¤ndler zuweisen</button><br />
      <span id="farm-chicken-type">Keine HÃ¼hner</span>
      <button id="assign-chicken-btn">â›“-HÃ¼hner zuweisen</button>
    </div>
    <div id="farm2" style="display: none">
      <h2>Bauernhof 2</h2>
      <span id="farm2-farmer-count">Farmer: 0</span>
      <button id="assign2-farmer-btn">Farmer zuweisen</button><br />
      <span id="farm2-merchant-count">HÃ¤ndler: 0</span>
      <button id="assign2-merchant-btn">HÃ¤ndler zuweisen</button><br />
      <span id="farm2-chicken-type">Keine HÃ¼hner</span>
      <button id="assign2-ground-btn">Bodenhaltung-HÃ¼hner zuweisen</button>
    </div>
    <button id="reset-btn">Reset</button>
    <div id="banner"></div>
    <script>
      const chicken = document.getElementById("chicken");
      const eggCountEl = document.getElementById("egg-count");
      const merchantCountEl = document.getElementById("merchant-count");
      const sellBtn = document.getElementById("sell-btn");
      const goldCountEl = document.getElementById("gold-count");
      const merchantBtn = document.getElementById("merchant-btn");
      const buyChickenBtn = document.getElementById("buy-chicken-btn");
      const buyGroundChickenBtn = document.getElementById("buy-ground-chicken-btn");
      const chickenCountEl = document.getElementById("chicken-count");
      const groundEggCountEl = document.getElementById("ground-egg-count");
      const sellGroundBtn = document.getElementById("sell-ground-btn");
      const farmerBtn = document.getElementById("farmer-btn");
      const farmerCountEl = document.getElementById("farmer-count");
      const buyFarmBtn = document.getElementById("buy-farm-btn");
      const buyFarm2Btn = document.getElementById("buy-farm2-btn");
      const farmEl = document.getElementById("farm");
      const farm2El = document.getElementById("farm2");
      const assignFarmerBtn = document.getElementById("assign-farmer-btn");
      const assignMerchantBtn = document.getElementById("assign-merchant-btn");
      const assignChickenBtn = document.getElementById("assign-chicken-btn");
      const assign2FarmerBtn = document.getElementById("assign2-farmer-btn");
      const assign2MerchantBtn = document.getElementById("assign2-merchant-btn");
      const assign2GroundBtn = document.getElementById("assign2-ground-btn");
      const farmFarmerCountEl = document.getElementById("farm-farmer-count");
      const farmMerchantCountEl = document.getElementById("farm-merchant-count");
      const farmChickenTypeEl = document.getElementById("farm-chicken-type");
      const farm2FarmerCountEl = document.getElementById("farm2-farmer-count");
      const farm2MerchantCountEl = document.getElementById("farm2-merchant-count");
      const farm2ChickenTypeEl = document.getElementById("farm2-chicken-type");
      const bannerEl = document.getElementById("banner");
      let count = 0;
      let gold = 0;
      let merchantCount = 0;
      let merchantVisible = false;
      let chickenCount = 1;
      let buyChickenVisible = false;
      let farmerCount = 0;
      let farmerVisible = false;
      let progressStage = 0;
      const progressGoals = [5, 10, 15, 100, 250, 1000];
      let farmBuilt = false;
      let farmFarmers = 0;
      let farmMerchants = 0;
      let farmChickenAssigned = false;
      let farmMultiplier = 1;
      let chapter2Shown = false;
      let farmChickenCount = 0;
      let groundEggCount = 0;
      let groundChickenCount = 0;
      let buyGroundChickenVisible = false;
      let farm2Built = false;
      let farm2Farmers = 0;
      let farm2Merchants = 0;
      let farm2ChickenAssigned = false;
      let farm2ChickenCount = 0;
      let farm2Multiplier = 1;
      let merchantCost = 5;
      let farmerCost = 15;
      let clickInterval;

      function saveGame() {
        const state = {
          count,
          gold,
          merchantCount,
          merchantVisible,
          chickenCount,
          buyChickenVisible,
          farmerCount,
          farmerVisible,
          progressStage,
          farmBuilt,
          farmFarmers,
          farmMerchants,
          farmChickenAssigned,
          farmMultiplier,
          chapter2Shown,
          farmChickenCount,
          groundEggCount,
          groundChickenCount,
          buyGroundChickenVisible,
          farm2Built,
          farm2Farmers,
          farm2Merchants,
          farm2ChickenAssigned,
          farm2ChickenCount,
          farm2Multiplier,
          merchantCost,
          farmerCost
        };
        localStorage.setItem("gameState", JSON.stringify(state));
      }

      function loadGame() {
        const saved = localStorage.getItem("gameState");
        if (saved) {
          const s = JSON.parse(saved);
          count = s.count;
          gold = s.gold;
          merchantCount = s.merchantCount;
          merchantVisible = s.merchantVisible;
          chickenCount = s.chickenCount;
          buyChickenVisible = s.buyChickenVisible;
          farmerCount = s.farmerCount;
          farmerVisible = s.farmerVisible;
          progressStage = s.progressStage;
          farmBuilt = s.farmBuilt;
          farmFarmers = s.farmFarmers;
          farmMerchants = s.farmMerchants;
          farmChickenAssigned = s.farmChickenAssigned;
          farmMultiplier = s.farmMultiplier;
          chapter2Shown = s.chapter2Shown;
          farmChickenCount = s.farmChickenCount;
          groundEggCount = s.groundEggCount || 0;
          groundChickenCount = s.groundChickenCount || 0;
          buyGroundChickenVisible = s.buyGroundChickenVisible || false;
          farm2Built = s.farm2Built || false;
          farm2Farmers = s.farm2Farmers || 0;
          farm2Merchants = s.farm2Merchants || 0;
          farm2ChickenAssigned = s.farm2ChickenAssigned || false;
          farm2ChickenCount = s.farm2ChickenCount || 0;
          farm2Multiplier = s.farm2Multiplier || 1;
          merchantCost = s.merchantCost || 5;
          farmerCost = s.farmerCost || 15;
          merchantBtn.style.display = merchantVisible ? "inline" : "none";
          buyChickenBtn.style.display = buyChickenVisible ? "inline" : "none";
          buyGroundChickenBtn.style.display = buyGroundChickenVisible ? "inline" : "none";
          farmerBtn.style.display = farmerVisible ? "inline" : "none";
          buyFarm2Btn.style.display = farm2Built ? "none" : "inline";
          farm2El.style.display = farm2Built ? "block" : "none";
          document.getElementById("container").style.display = farmChickenAssigned ? "none" : "block";
        }
      }

      function showBanner(text) {
        bannerEl.textContent = text;
        bannerEl.style.display = "block";
        setTimeout(() => {
          bannerEl.style.display = "none";
        }, 5000);
      }

      function updateDisplays() {
        eggCountEl.textContent = "â›“-Ei: " + count;
        groundEggCountEl.textContent = "Boden-Ei: " + groundEggCount;
        groundEggCountEl.style.display = groundEggCount > 0 ? "block" : "none";
        merchantBtn.textContent = `HÃ¤ndler anheuern (${merchantCost}ğŸª™)`;
        farmerBtn.textContent = `Farmer anheuern (${farmerCost}ğŸª™)`;
        if (merchantCount > 0) {
          merchantCountEl.style.display = "block";
          merchantCountEl.textContent = "HÃ¤ndler: " + merchantCount;
        } else {
          merchantCountEl.style.display = "none";
        }
        if (farmerCount > 0) {
          farmerCountEl.style.display = "block";
          farmerCountEl.textContent = "Farmer: " + farmerCount;
        } else {
          farmerCountEl.style.display = "none";
        }
        if (chickenCount > 1) {
          chickenCountEl.style.display = "block";
          chickenCountEl.textContent = "â›“-HÃ¼hner: " + chickenCount;
        } else {
          chickenCountEl.style.display = "none";
        }
        const nextGoal = progressGoals[progressStage];
        if (nextGoal !== undefined) {
          goldCountEl.textContent = "ğŸª™ " + gold + "/" + nextGoal;
        } else {
          goldCountEl.textContent = "ğŸª™ " + gold;
        }
        if (!merchantVisible && gold >= merchantCost) {
          merchantBtn.style.display = "inline";
          merchantVisible = true;
        }
        if (!buyChickenVisible && gold >= 10) {
          buyChickenBtn.style.display = "inline";
          buyChickenVisible = true;
        }
        if (!farmerVisible && gold >= farmerCost) {
          farmerBtn.style.display = "inline";
          farmerVisible = true;
        }
        if (!farmBuilt && gold >= 100) {
          buyFarmBtn.style.display = "inline";
        } else {
          buyFarmBtn.style.display = "none";
        }
        if (progressStage === 4 && gold >= progressGoals[4]) {
          progressStage += 1;
        }
        if (progressStage >= 5) {
          if (!buyGroundChickenVisible) {
            buyGroundChickenBtn.style.display = "inline";
            buyGroundChickenVisible = true;
          }
          if (!farm2Built) {
            buyFarm2Btn.style.display = gold >= 1000 ? "inline" : "none";
          } else {
            buyFarm2Btn.style.display = "none";
          }
        }
        farm2El.style.display = farm2Built ? "block" : "none";
        farm2FarmerCountEl.textContent = "Farmer: " + farm2Farmers;
        farm2MerchantCountEl.textContent = "HÃ¤ndler: " + farm2Merchants;
        farm2ChickenTypeEl.textContent = farm2ChickenAssigned
          ? "BodenhaltungshÃ¼hner"
          : "Keine HÃ¼hner";
        farmEl.style.display = farmBuilt ? "block" : "none";
        farmFarmerCountEl.textContent = "Farmer: " + farmFarmers;
        farmMerchantCountEl.textContent = "HÃ¤ndler: " + farmMerchants;
        farmChickenTypeEl.textContent = farmChickenAssigned
          ? "â›“fighaltungshÃ¼hner"
          : "Keine HÃ¼hner";
        if (progressStage >= 3 && gold >= 100 && !chapter2Shown) {
          showBanner("Kapitel 2: MarkteinfÃ¼hrung");
          chapter2Shown = true;
          merchantCost = 10;
          farmerCost = 30;
        }
        sellGroundBtn.style.display = groundEggCount >= 8 ? "inline" : "none";
        saveGame();
      }

      // Initial display update
      loadGame();
      updateDisplays();

      function spawnEgg(amount) {
        for (let i = 0; i < amount; i++) {
          const egg = document.createElement("div");
          egg.className = "egg";
          egg.textContent = "ğŸ¥š";
          document.getElementById("container").appendChild(egg);
          setTimeout(() => egg.remove(), 3000);
        }
      }

      function produceEgg() {
        if (chickenCount <= 0) return;
        count += chickenCount;
        if (count >= 50) {
          sellBtn.style.display = "inline";
        }
        spawnEgg(chickenCount);
        updateDisplays();
      }

      chicken.addEventListener("mousedown", () => {
        produceEgg();
        clickInterval = setInterval(produceEgg, 500);
      });

      ["mouseup", "mouseleave"].forEach((ev) => {
        chicken.addEventListener(ev, () => clearInterval(clickInterval));
      });

      sellBtn.addEventListener("click", () => {
        if (count >= 8) {
          count -= 8;
          gold += 1;
          updateDisplays();
        }
      });

      sellGroundBtn.addEventListener("click", () => {
        if (groundEggCount >= 8) {
          groundEggCount -= 8;
          gold += 2;
          updateDisplays();
        }
      });

      merchantBtn.addEventListener("click", () => {
        if (gold >= merchantCost) {
          gold -= merchantCost;
          merchantCount += 1;
          if (progressStage === 0) {
            progressStage += 1;
          }
          updateDisplays();
        }
      });

      farmerBtn.addEventListener("click", () => {
        if (gold >= farmerCost) {
          gold -= farmerCost;
          farmerCount += 1;
          if (progressStage === 2) {
            progressStage += 1;
          }
          updateDisplays();
        }
      });

      buyChickenBtn.addEventListener("click", () => {
        if (gold >= 10) {
          gold -= 10;
          if (farmChickenAssigned) {
            farmChickenCount += 1;
          } else {
            chickenCount += 1;
          }
          if (progressStage === 1) {
            progressStage += 1;
          }
          updateDisplays();
        }
      });

      buyGroundChickenBtn.addEventListener("click", () => {
        if (gold >= 250) {
          gold -= 250;
          if (farm2ChickenAssigned) {
            farm2ChickenCount += 1;
          } else {
            groundChickenCount += 1;
          }
          if (progressStage === 5) {
            progressStage += 1;
          }
          updateDisplays();
        }
      });

      buyFarmBtn.addEventListener("click", () => {
        if (gold >= 100 && !farmBuilt) {
          gold -= 100;
          farmBuilt = true;
          progressStage += 1;
          updateDisplays();
        }
      });

      buyFarm2Btn.addEventListener("click", () => {
        if (gold >= 1000 && !farm2Built) {
          gold -= 1000;
          farm2Built = true;
          updateDisplays();
        }
      });

      assignFarmerBtn.addEventListener("click", () => {
        if (farmerCount > 0 && farmBuilt) {
          farmerCount -= 1;
          farmFarmers += 1;
          updateDisplays();
        }
      });

      assignMerchantBtn.addEventListener("click", () => {
        if (merchantCount > 0 && farmBuilt) {
          merchantCount -= 1;
          farmMerchants += 1;
          updateDisplays();
        }
      });

      assignChickenBtn.addEventListener("click", () => {
        if (farmBuilt && !farmChickenAssigned && chickenCount > 0) {
          farmChickenAssigned = true;
          farmChickenCount += chickenCount;
          chickenCount = 0;
          farmMultiplier = 1.15;
          document.getElementById("container").style.display = "none";
          updateDisplays();
        }
      });

      assign2FarmerBtn.addEventListener("click", () => {
        if (farmerCount > 0 && farm2Built) {
          farmerCount -= 1;
          farm2Farmers += 1;
          updateDisplays();
        }
      });

      assign2MerchantBtn.addEventListener("click", () => {
        if (merchantCount > 0 && farm2Built) {
          merchantCount -= 1;
          farm2Merchants += 1;
          updateDisplays();
        }
      });

      assign2GroundBtn.addEventListener("click", () => {
        if (farm2Built && !farm2ChickenAssigned && groundChickenCount > 0) {
          farm2ChickenAssigned = true;
          farm2ChickenCount += groundChickenCount;
          groundChickenCount = 0;
          farm2Multiplier = 1.15;
          updateDisplays();
        }
      });

      document.getElementById("reset-btn").addEventListener("click", () => {
        localStorage.removeItem("gameState");
        count = 0;
        gold = 0;
        merchantCount = 0;
        merchantVisible = false;
        chickenCount = 1;
        buyChickenVisible = false;
        farmerCount = 0;
        farmerVisible = false;
        progressStage = 0;
        farmBuilt = false;
        farmFarmers = 0;
        farmMerchants = 0;
        farmChickenAssigned = false;
        farmMultiplier = 1;
        chapter2Shown = false;
        farmChickenCount = 0;
        groundEggCount = 0;
        groundChickenCount = 0;
        buyGroundChickenVisible = false;
        farm2Built = false;
        farm2Farmers = 0;
        farm2Merchants = 0;
        farm2ChickenAssigned = false;
        farm2ChickenCount = 0;
        farm2Multiplier = 1;
        merchantCost = 5;
        farmerCost = 15;
        document.getElementById("container").style.display = "block";
        merchantBtn.style.display = "none";
        buyChickenBtn.style.display = "none";
        buyGroundChickenBtn.style.display = "none";
        farmerBtn.style.display = "none";
        buyFarm2Btn.style.display = "none";
        farm2El.style.display = "none";
        updateDisplays();
      });
      setInterval(() => {
        if (farmerCount > 0 && chickenCount > 0) {
          count += farmerCount;
          if (count >= 50) {
            sellBtn.style.display = "inline";
          }
          spawnEgg(farmerCount);
          updateDisplays();
        }
        if (farmBuilt && farmChickenAssigned && farmFarmers > 0) {
          const produced = Math.round(farmFarmers * farmMultiplier);
          count += produced;
          if (count >= 50) {
            sellBtn.style.display = "inline";
          }
          spawnEgg(produced);
          updateDisplays();
        }
        if (farm2Built && farm2ChickenAssigned && farm2Farmers > 0) {
          const produced2 = Math.round(farm2Farmers * farm2Multiplier);
          groundEggCount += produced2;
          if (groundEggCount >= 8) {
            sellGroundBtn.style.display = "inline";
          }
          spawnEgg(produced2);
          updateDisplays();
        }
      }, 1000);

      setInterval(() => {
        const merchants = merchantCount + farmMerchants + farm2Merchants;
        let sales = merchants;
        const possibleSales = Math.floor(count / 8);
        const regSales = Math.min(possibleSales, sales);
        if (regSales > 0) {
          count -= regSales * 8;
          gold += regSales;
          sales -= regSales;
        }
        const possibleGround = Math.floor(groundEggCount / 8);
        const groundSales = Math.min(possibleGround, sales);
        if (groundSales > 0) {
          groundEggCount -= groundSales * 8;
          gold += groundSales * 2;
        }
        if (regSales > 0 || groundSales > 0) {
          updateDisplays();
        }
      }, 5000);
    </script>
  </body>
</html>
